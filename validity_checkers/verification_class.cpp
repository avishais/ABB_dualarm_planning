/*
 * veification_class.cpp
 *
 *  Created on: Aug 1, 2017
 *      Author: avishai
 */

#include "verification_class.h"

bool verification_class::verify_path() {

	cout << "Verifying path in file: " << path_file << "..." << endl;

	State q(12);
	Matrix M;
	int tmp;

	ifstream fq;
	fq.open(path_file);

	fq >> tmp;

	int i = 0;
	while(!fq.eof()) {
		for (int j=0; j < 12; j++) {
			fq >> q[j];
		}
		M.push_back(q);
		i++;
	}
	fq.close();

	bool vrf = verify_path(M);

	if (vrf) {
		cout << "***************************************" << endl;
		cout << "************ PATH FEASIBLE ************" << endl;
		cout << "***************************************" << endl;
	}
	else {
		cout << "***************************************" << endl;
		cout << "*********** ! PATH FAILED ! ***********" << endl;
		cout << "***************************************" << endl;
	}

	return vrf;
}

bool verification_class::verify_path(Matrix M) {

	int m = M.size();

	// Validate joint limits
	for (int i = 0; i < m; i++) {
		if (!check_angle_limits(M[i])) {
			cout << "***************************************" << endl;
			cout << "@ Joint limits failure!" << endl;
			cout << "@ Node " << i << endl;
			return false; // Report joint limit breach
		}
	}

	// Validate continuity
	for (int i = 1; i < m; i++) {
		//cout << normDistance(M[i],M[i-1]) << endl;
		if (normDistance(M[i],M[i-1]) > continuity_tol) {
			cout << "***************************************" << endl;
			cout << "@ Discontinuity failure!" << endl;
			cout << "@ Node " << i << endl;
			return false; // Report discontinuity
		}
	}

	// Validate closure constraint
	for (int i = 0; i < m; i++) {
		if (!test_constraint(M[i])) {
			cout << "***************************************" << endl;
			cout << "@ Closure constraint failure!" << endl;
			cout << "@ Node " << i << endl;
			return false;
		}
	}

	// Validate collisions
	State q1(M[0].size()/2), q2(M[0].size()/2);
	for (int i = 0; i < m; i++) {
		seperate_Vector(M[i], q1, q2);
		if (collision_state(getPMatrix(), q1, q2)) {
			cout << "***************************************" << endl;
			cout << "@ Collision failure!" << endl;
			cout << "@ Node " << i << endl;
			return false;
		}
	}

	return true; // No errors
}

void verification_class::log_path_file(Matrix M) {

	std::ofstream mf;

	mf.open(path_file);

	mf << M.size() << endl;

	for (int i = 0; i < M.size(); i++) {
		for (int j = 0; j < M[0].size(); j++)
			mf << M[i][j] << " ";
		mf << endl;
	}

	mf.close();
}

bool verification_class::test_constraint(State q) {
	Matrix Tsb = Tsb_matrix(q);

	bool valid = true;
	for (int j = 0; j < 3 && valid; j++)
		for (int k = 0; k < 4; k++) {
			if ((k < 3 && fabs(Tsb[j][k]-Tsd[j][k]) > 0.1) || (k==3 && fabs(Tsb[j][k]-Tsd[j][k]) > 0.5)) {
				printVector(q);
				printMatrix(Tsb);
				printMatrix(Tsd);
				valid = false;
				break;
			}

		}
	return valid;

}

Matrix verification_class::Tsb_matrix(State q) {

	// Based on the transformation matrices comparison (12x1)
	// State C = { cos(rot1)*(sin(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2]))) + cos(rot2)*(sin(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) - cos(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8]))) + sin(rot1)*(sin(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0]))) + sin(rot2)*(sin(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) - cos(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6]))), sin(rot1)*(sin(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2]))) + sin(rot2)*(sin(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) - cos(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8]))) - cos(rot1)*(sin(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0]))) - cos(rot2)*(sin(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) - cos(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6]))), sin(q[1] + q[2])*cos(q[4]) + sin(q[7] + q[8])*cos(q[10]) + cos(q[1] + q[2])*cos(q[3])*sin(q[4]) + cos(q[7] + q[8])*cos(q[9])*sin(q[10]), cos(rot1)*(cos(q[5])*(cos(q[3])*sin(q[0]) - sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) + sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2])))) + cos(rot2)*(cos(q[11])*(cos(q[9])*sin(q[6]) - sin(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) - sin(q[11])*(cos(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) + sin(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8])))) + sin(rot1)*(cos(q[5])*(cos(q[0])*cos(q[3]) + sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) + sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0])))) + sin(rot2)*(cos(q[11])*(cos(q[6])*cos(q[9]) + sin(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) - sin(q[11])*(cos(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) + sin(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6])))), sin(rot1)*(cos(q[5])*(cos(q[3])*sin(q[0]) - sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) + sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2])))) + sin(rot2)*(cos(q[11])*(cos(q[9])*sin(q[6]) - sin(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) - sin(q[11])*(cos(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) + sin(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8])))) - cos(rot1)*(cos(q[5])*(cos(q[0])*cos(q[3]) + sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) + sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0])))) - cos(rot2)*(cos(q[11])*(cos(q[6])*cos(q[9]) + sin(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) - sin(q[11])*(cos(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) + sin(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6])))), sin(q[5])*(sin(q[1] + q[2])*sin(q[4]) - cos(q[1] + q[2])*cos(q[3])*cos(q[4])) + sin(q[11])*(sin(q[7] + q[8])*sin(q[10]) - cos(q[7] + q[8])*cos(q[9])*cos(q[10])) - cos(q[1] + q[2])*cos(q[5])*sin(q[3]) - cos(q[7] + q[8])*cos(q[11])*sin(q[9]), cos(rot1)*(sin(q[5])*(cos(q[3])*sin(q[0]) - sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) + cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) + sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2])))) - cos(rot2)*(sin(q[11])*(cos(q[9])*sin(q[6]) - sin(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) + cos(q[11])*(cos(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) + sin(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8])))) + sin(rot1)*(sin(q[5])*(cos(q[0])*cos(q[3]) + sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) + cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) + sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0])))) - sin(rot2)*(sin(q[11])*(cos(q[6])*cos(q[9]) + sin(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) + cos(q[11])*(cos(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) + sin(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6])))), sin(rot1)*(sin(q[5])*(cos(q[3])*sin(q[0]) - sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) + cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) + sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2])))) - sin(rot2)*(sin(q[11])*(cos(q[9])*sin(q[6]) - sin(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) + cos(q[11])*(cos(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) + sin(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8])))) - cos(rot1)*(sin(q[5])*(cos(q[0])*cos(q[3]) + sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) + cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) + sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0])))) + cos(rot2)*(sin(q[11])*(cos(q[6])*cos(q[9]) + sin(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) + cos(q[11])*(cos(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) + sin(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6])))), cos(q[11])*(sin(q[7] + q[8])*sin(q[10]) - cos(q[7] + q[8])*cos(q[9])*cos(q[10])) - cos(q[5])*(sin(q[1] + q[2])*sin(q[4]) - cos(q[1] + q[2])*cos(q[3])*cos(q[4])) - cos(q[1] + q[2])*sin(q[3])*sin(q[5]) + cos(q[7] + q[8])*sin(q[9])*sin(q[11]), r1x - r2x - sin(rot1)*(lee*(sin(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0]))) + l3a*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1])) - (l3b + l4)*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0])) + l5*(sin(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0]))) + l2*sin(q[0])*sin(q[1])) + sin(rot2)*(lee*(sin(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) - cos(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6]))) + l3a*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7])) - (l3b + l4)*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6])) + l5*(sin(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) - cos(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6]))) + l2*sin(q[6])*sin(q[7])) + cos(rot1)*((l3b + l4)*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2])) - l5*(sin(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2]))) - lee*(sin(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2]))) + l3a*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1])) + l2*cos(q[0])*sin(q[1])) - cos(rot2)*((l3b + l4)*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8])) - l5*(sin(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) - cos(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8]))) - lee*(sin(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) - cos(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8]))) + l3a*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7])) + l2*cos(q[6])*sin(q[7])) - L*(cos(rot1)*(sin(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2]))) + sin(rot1)*(sin(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0])))), r1y - r2y + sin(rot1)*((l3b + l4)*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2])) - l5*(sin(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2]))) - lee*(sin(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2]))) + l3a*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1])) + l2*cos(q[0])*sin(q[1])) - sin(rot2)*((l3b + l4)*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8])) - l5*(sin(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) - cos(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8]))) - lee*(sin(q[10])*(sin(q[6])*sin(q[9]) + cos(q[9])*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7]))) - cos(q[10])*(cos(q[6])*cos(q[7])*cos(q[8]) - cos(q[6])*sin(q[7])*sin(q[8]))) + l3a*(cos(q[6])*cos(q[7])*sin(q[8]) + cos(q[6])*cos(q[8])*sin(q[7])) + l2*cos(q[6])*sin(q[7])) - L*(sin(rot1)*(sin(q[4])*(sin(q[0])*sin(q[3]) + cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2]) + cos(q[0])*cos(q[2])*sin(q[1]))) - cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2]) - cos(q[0])*sin(q[1])*sin(q[2]))) - cos(rot1)*(sin(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0])))) + cos(rot1)*(lee*(sin(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0]))) + l3a*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1])) - (l3b + l4)*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0])) + l5*(sin(q[4])*(cos(q[0])*sin(q[3]) - cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2]) + cos(q[2])*sin(q[0])*sin(q[1]))) - cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2]) - cos(q[1])*cos(q[2])*sin(q[0]))) + l2*sin(q[0])*sin(q[1])) - cos(rot2)*(lee*(sin(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) - cos(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6]))) + l3a*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7])) - (l3b + l4)*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6])) + l5*(sin(q[10])*(cos(q[6])*sin(q[9]) - cos(q[9])*(cos(q[7])*sin(q[6])*sin(q[8]) + cos(q[8])*sin(q[6])*sin(q[7]))) - cos(q[10])*(sin(q[6])*sin(q[7])*sin(q[8]) - cos(q[7])*cos(q[8])*sin(q[6]))) + l2*sin(q[6])*sin(q[7])), l3a*cos(q[1] + q[2]) - l3a*cos(q[7] + q[8]) - l3b*sin(q[1] + q[2]) + l3b*sin(q[7] + q[8]) - l4*sin(q[1] + q[2]) + l4*sin(q[7] + q[8]) + l2*cos(q[1]) - l2*cos(q[7]) - L*(sin(q[1] + q[2])*cos(q[4]) + cos(q[1] + q[2])*cos(q[3])*sin(q[4])) - (l5*cos(q[1] + q[2])*sin(q[3] + q[4]))/2 + (l5*cos(q[7] + q[8])*sin(q[9] + q[10]))/2 - (lee*cos(q[1] + q[2])*sin(q[3] + q[4]))/2 + (lee*cos(q[7] + q[8])*sin(q[9] + q[10]))/2 - l5*sin(q[1] + q[2])*cos(q[4]) + l5*sin(q[7] + q[8])*cos(q[10]) - lee*sin(q[1] + q[2])*cos(q[4]) + lee*sin(q[7] + q[8])*cos(q[10]) + (l5*sin(q[3] - q[4])*cos(q[1] + q[2]))/2 - (l5*sin(q[9] - q[10])*cos(q[7] + q[8]))/2 + (lee*sin(q[3] - q[4])*cos(q[1] + q[2]))/2 - (lee*sin(q[9] - q[10])*cos(q[7] + q[8]))/2};

	// Based on the position and orientation comparison (6x1)
	Matrix Tsb;
	initMatrix(Tsb, 4, 4);

	Tsb[0][0] = cos(q[6])*(sin(q[7])*(sin(q[8])*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))+cos(q[8])*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))))))-cos(q[7])*(cos(q[8])*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[8])*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))))+sin(q[6])*(sin(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))+cos(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))));
	Tsb[0][1] = sin(q[6])*(sin(q[7])*(sin(q[8])*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))+cos(q[8])*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))))))-cos(q[7])*(cos(q[8])*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[8])*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))))-cos(q[6])*(sin(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))+cos(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))));
	Tsb[0][2] = -sin(q[7])*(cos(q[8])*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[8])*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))))))-cos(q[7])*(sin(q[8])*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))+cos(q[8])*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))))));
	Tsb[0][3] = l3a*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1]))+l3a*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))+l2*(sin(q[8])*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))+cos(q[8])*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))))))+(l4+l3b)*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))-l5*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))*2.0-(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))*(L+lee*2.0)-(l4+l3b)*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))+(b+l1)*(sin(q[7])*(cos(q[8])*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[8])*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))))))+cos(q[7])*(sin(q[8])*(cos(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))+sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))+cos(q[8])*(cos(q[9])*(sin(q[10])*(sin(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-cos(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2])))-cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))+sin(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))-sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))-sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))-sin(q[11])*(sin(q[5])*(cos(q[3])*sin(q[0])-sin(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+cos(q[5])*(cos(q[4])*(sin(q[0])*sin(q[3])+cos(q[3])*(cos(q[0])*cos(q[1])*sin(q[2])+cos(q[0])*cos(q[2])*sin(q[1])))+sin(q[4])*(cos(q[0])*cos(q[1])*cos(q[2])-cos(q[0])*sin(q[1])*sin(q[2]))))))))+l2*cos(q[0])*sin(q[1]);
	Tsb[1][0] = -sin(q[6])*(cos(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[6])*(cos(q[7])*(sin(q[8])*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))+cos(q[8])*(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+sin(q[7])*(cos(q[8])*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))-sin(q[8])*(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))));
	Tsb[1][1] = cos(q[6])*(cos(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+sin(q[6])*(cos(q[7])*(sin(q[8])*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))+cos(q[8])*(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+sin(q[7])*(cos(q[8])*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))-sin(q[8])*(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))));
	Tsb[1][2] = -cos(q[7])*(cos(q[8])*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))-sin(q[8])*(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+sin(q[7])*(sin(q[8])*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))+cos(q[8])*(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))));
	Tsb[1][3] = (sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))*(L+lee*2.0)+l3a*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1]))+l2*(cos(q[8])*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))-sin(q[8])*(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))*(l4+l3b)+l3a*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))+(cos(q[7])*(cos(q[8])*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))-sin(q[8])*(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[7])*(sin(q[8])*(cos(q[9])*(cos(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))-sin(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[9])*(cos(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))-sin(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))+cos(q[8])*(sin(q[10])*(cos(q[11])*(sin(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+cos(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))+sin(q[11])*(cos(q[5])*(cos(q[0])*cos(q[3])+sin(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))+sin(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))))+cos(q[10])*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))))))*(b+l1)-(l4+l3b)*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0]))+l5*(sin(q[4])*(cos(q[0])*sin(q[3])-cos(q[3])*(cos(q[1])*sin(q[0])*sin(q[2])+cos(q[2])*sin(q[0])*sin(q[1])))-cos(q[4])*(sin(q[0])*sin(q[1])*sin(q[2])-cos(q[1])*cos(q[2])*sin(q[0])))*2.0+l2*sin(q[0])*sin(q[1]);
	Tsb[2][0] = -cos(q[6])*(cos(q[7])*(sin(q[8])*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))-cos(q[8])*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))))+sin(q[7])*(cos(q[8])*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))+sin(q[8])*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))+sin(q[6])*(cos(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))+sin(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))));
	Tsb[2][1] = -sin(q[6])*(cos(q[7])*(sin(q[8])*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))-cos(q[8])*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))))+sin(q[7])*(cos(q[8])*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))+sin(q[8])*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))-cos(q[6])*(cos(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))+sin(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))));
	Tsb[2][2] = cos(q[7])*(cos(q[8])*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))+sin(q[8])*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))))-sin(q[7])*(sin(q[8])*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))-cos(q[8])*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))));
	Tsb[2][3] = b+l1-(l4+l3b)*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+(l4+l3b)*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-l3a*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))+l3a*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))-(b+l1)*(cos(q[7])*(cos(q[8])*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))+sin(q[8])*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))))-sin(q[7])*(sin(q[8])*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))-cos(q[8])*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))-l5*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))*2.0+l2*cos(q[1])-(L+lee*2.0)*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-l2*(cos(q[8])*(sin(q[9])*(cos(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[9])*(sin(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+cos(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))))+sin(q[8])*(sin(q[10])*(cos(q[11])*(cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))+sin(q[3])*sin(q[5])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-sin(q[11])*(sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))-cos(q[3])*cos(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))-cos(q[5])*sin(q[3])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2]))))-cos(q[10])*(cos(q[4])*(cos(q[1])*sin(q[2])+cos(q[2])*sin(q[1]))+cos(q[3])*sin(q[4])*(cos(q[1])*cos(q[2])-sin(q[1])*sin(q[2])))));
	Tsb[3][3] = 1.0;

	return Tsb;

}


